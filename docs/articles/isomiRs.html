<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Characterization of miRNA and isomiR molecules • isomiRs</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Characterization of miRNA and isomiR molecules">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">isomiRs</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.9.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/isomiRs.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Characterization of miRNA and isomiR molecules</h1>
                        <h4 class="author">Lorena Pantano</h4>
            
            <h4 class="date">12 October 2018</h4>
      
      
      <div class="hidden name"><code>isomiRs.Rmd</code></div>

    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>isomiRs package version: 1.9.1</p>
    </div>
    
<p><a href="lorena.pantano@gmail.com">Lorena Pantano</a> Harvard TH Chan School of Public Health, Boston, US</p>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>miRNAs are small RNA fragments (18-23 nt long) that influence gene expression during development and cell stability. Morin et al <span class="citation">(Morin et al. 2008)</span>, discovered isomiRs first time after sequencing human stem cells.</p>
<p>IsomiRs are miRNAs that vary slightly in sequence, which result from variations in the cleavage site during miRNA biogenesis (5’-trimming and 3’-trimming variants), nucleotide additions to the 3’-end of the mature miRNA (3’-addition variants) and nucleotide modifications (substitution variants)<span class="citation">(Martí et al. 2010)</span>.</p>
<p>There are many tools designed for isomiR detection, however the majority are web application where user can not control the analysis. The two main command tools for isomiRs mapping are SeqBuster and sRNAbench <span class="citation">(Guillermo et al. 2014)</span>. <em><a href="http://bioconductor.org/packages/isomiRs">isomiRs</a></em>. package is designed to analyze the output of SeqBuster tool or any other tool after converting to the desire format.</p>
</div>
<div id="citing-isomirs" class="section level2">
<h2 class="hasAnchor">
<a href="#citing-isomirs" class="anchor"></a>Citing isomiRs</h2>
<p>If you use the package, please cite this paper <span class="citation">(Pantano L 2010)</span>.</p>
</div>
<div id="input-format" class="section level2">
<h2 class="hasAnchor">
<a href="#input-format" class="anchor"></a>Input format</h2>
<p>The input should be the output of SeqBuster-miraligner tool (*.mirna files). It is compatible with <a href="http://github.com/mirtop/mirtop">mirTOP</a> tool as well, which parses BAM files with alignments against miRNA precursors.</p>
<p>For each sample the file should have the following format:</p>
<pre><code>seq                     name           freq mir           start end  mism  add  t5  t3
TGTAAACATCCTACACTCAGCT  seq_100014_x23  23  hsa-miR-30b-5p  17  40   0       0  0   GT
TGTAAACATCCCTGACTGGAA   seq_100019_x4   4   hsa-miR-30d-5p  6   26   13TC    0  0   g
TGTAAACATCCCTGACTGGAA   seq_100019_x4   4   hsa-miR-30e-5p  17  37   12CT    0  0   g
CAAATTCGTATCTAGGGGATT   seq_100049_x1   1   hsa-miR-10a-3p  63  81   0       TT 0   ata
TGACCTAGGAATTGACAGCCAGT seq_100060_x1   1   hsa-miR-192-5p  25  47   8GT     0  c   agt</code></pre>
<p>This is the standard output of SeqBuster-miraligner tool, but can be converted from any other tool having the mapping information on the precursors. Read more on <a href="http://seqcluster.readthedocs.org/mirna_annotation.html">miraligner manual</a>.</p>
</div>
<div id="isomirdataseq-class" class="section level2">
<h2 class="hasAnchor">
<a href="#isomirdataseq-class" class="anchor"></a>IsomirDataSeq class</h2>
<p>This object will store all raw data from the input files and some processed information used for visualization and statistical analysis. It is a subclass of <code>SummarizedExperiment</code> with <code>colData</code> and <code>counts</code> methods. Beside that, the object contains raw and normalized counts from miraligner allowing to update the summarization of miRNA expression.</p>
<div id="access-data" class="section level3">
<h3 class="hasAnchor">
<a href="#access-data" class="anchor"></a>Access data</h3>
<p>The user can access the normalized count matrix with <code><a href="../reference/counts.html">counts(object, norm=TRUE)</a></code>.</p>
<p>You can browse for the same miRNA or isomiRs in all samples with <code>isoSelect</code> method.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(isomiRs)
<span class="kw">data</span>(mirData)
<span class="kw">head</span>(<span class="kw"><a href="../reference/isoSelect.html">isoSelect</a></span>(mirData, <span class="dt">mirna=</span><span class="st">"hsa-let-7a-5p"</span>, <span class="dv">1000</span>))</code></pre></div>
<pre><code>## DataFrame with 6 rows and 14 columns
##                                cc1       cc2       cc3       cc4       cc5
##                          &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;
## hsa-let-7a-5p               235825    171354    149541    180654    168884
## hsa-let-7a-5p;iso_3p:gtt      1173       884       751      1010       963
## hsa-let-7a-5p;iso_3p:t       50920     52403     35525     53213     51499
## hsa-let-7a-5p;iso_3p:T        8806      5478      5427      6249      5538
## hsa-let-7a-5p;iso_3p:tt       6041      5467      3817      7491      6394
## hsa-let-7a-5p;iso_add:A       9616      4742      5437      6714      5846
##                                cc6       cc7       ct1       ct2       ct3
##                          &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;
## hsa-let-7a-5p               107430    153061    143030    163569    114028
## hsa-let-7a-5p;iso_3p:gtt       580       863       927       756       495
## hsa-let-7a-5p;iso_3p:t       30659     45492     42878     35795     24993
## hsa-let-7a-5p;iso_3p:T        3734      5482      4825      6045      4626
## hsa-let-7a-5p;iso_3p:tt       3984      5940      7107      4828      2858
## hsa-let-7a-5p;iso_add:A       3799      5532      5214      7326      4790
##                                ct4       ct5       ct6       ct7
##                          &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;
## hsa-let-7a-5p               123454    133092    158909    140272
## hsa-let-7a-5p;iso_3p:gtt       719       682      1048       860
## hsa-let-7a-5p;iso_3p:t       34512     36973     47873     39585
## hsa-let-7a-5p;iso_3p:T        4181      4505      5134      4670
## hsa-let-7a-5p;iso_3p:tt       5087      5652      6589      5447
## hsa-let-7a-5p;iso_add:A       4430      5010      6034      5081</code></pre>
<p><code>metadata(mirData)</code> contains two lists: <code>rawList</code> is a list with same length than number of samples and stores the input files for each sample; <code>isoList</code> is a list with same length than number of samples and stores information for each isomiR type summarizing the different changes for the different isomiRs (trimming at 3’, trimming a 5’, addition and substitution). For instance, you can get the data stored in <code>isoList</code> for sample 1 and 5’ changes with this code <code>metadata(ids)[["isoList"]][[1]]["t5sum"]</code>.</p>
</div>
<div id="isomirs-annotation" class="section level3">
<h3 class="hasAnchor">
<a href="#isomirs-annotation" class="anchor"></a>isomiRs annotation</h3>
<p>IsomiR names follows this structure:</p>
<ul>
<li>miRNA name</li>
<li>type: ref if the sequence is the same than the miRNA reference. <code>iso</code> if the sequence has variations. <em>t5 tag: indicates variations at 5’ position. The naming contains two words: <code>direction - nucleotides</code>, where direction can be UPPER CASE NT (changes upstream of the 5’ reference position) or LOWER CASE NT (changes downstream of the 5’ reference position). <code>0</code> indicates no variation, meaning the 5’ position is the same than the reference. After <code>direction</code>, it follows the nucleotide/s that are added (for upstream changes) or deleted (for downstream changes). </em>t3 tag: indicates variations at 3’ position. The naming contains two words: <code>direction - nucleotides</code>, where direction can be LOWER CASE NT (upstream of the 3’ reference position) or UPPER CASE NT (downstream of the 3’ reference position). <code>0</code> indicates no variation, meaning the 3’ position is the same than the reference. After <code>direction</code>, it follows the nucleotide/s that are added (for downstream changes) or deleted (for upstream chanes). <em>ad tag: indicates nucleotides additions at 3’ position. The naming contains two words: <code>direction - nucleotides</code>, where direction is UPPER CASE NT (upstream of the 5’ reference position). <code>0</code> indicates no variation, meaning the 3’ position has no additions. After <code>direction</code>, it follows the nucleotide/s that are added. </em>mm tag: indicates nucleotides substitutions along the sequences. The naming contains three words: <code>position-nucleotideATsequence-nucleotideATreference</code>. *seed tag: same than <code>mm</code> tag, but only if the change happens between nucleotide 2 and 8.</li>
</ul>
<p>In general nucleotides in UPPER case mean insertions respect to the reference sequence, and nucleotides in LOWER case mean deletions respect to the reference sequence.</p>
</div>
</div>
<div id="reading-input" class="section level2">
<h2 class="hasAnchor">
<a href="#reading-input" class="anchor"></a>Reading input</h2>
<p>We are going to use a small RNAseq data from human brain samples <span class="citation">(<span class="citeproc-not-found" data-reference-id="pantano2016"><strong>???</strong></span>)</span> to give some basic examples of isomiRs analyses.</p>
<p>In this data set we will find two groups:</p>
<p><em>pc: 7 control individuals </em>pt: 7 patients with Parkinson’s Disease in early stage.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(isomiRs)
<span class="kw">data</span>(mirData)</code></pre></div>
<p>The function <code>IsomirDataSeqFromFiles</code> needs a vector with the paths for each file and a data frame with the design experiment similar to the one used for a mRNA differential expression analysis. Row names of the data frame should be the names for each sample in the same order than the list of files.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ids &lt;-<span class="st"> </span><span class="kw"><a href="../reference/IsomirDataSeqFromFiles.html">IsomirDataSeqFromFiles</a></span>(fn_list, <span class="dt">design=</span>de)</code></pre></div>
</div>
<div id="descriptive-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#descriptive-analysis" class="anchor"></a>Descriptive analysis</h2>
<p>You can plot isomiRs expression with <code>isoPlot</code>. In this figure you will see how abundant is each type of isomiRs at different positions considering the total abundance and the total number of sequences. The <code>type</code> parameter controls what type of isomiRs to show. It can be trimming (iso5 and iso3), addition (add) or substitution (subs) changes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ids &lt;-<span class="st"> </span><span class="kw"><a href="../reference/isoCounts.html">isoCounts</a></span>(mirData)
<span class="kw"><a href="../reference/isoPlot.html">isoPlot</a></span>(ids, <span class="dt">type=</span><span class="st">"all"</span>)</code></pre></div>
<p><img src="isomiRs_files/figure-html/package-plot-iso-t5-1.png" width="700"></p>
</div>
<div id="count-data" class="section level2">
<h2 class="hasAnchor">
<a href="#count-data" class="anchor"></a>Count data</h2>
<p><code>isoCounts</code> gets the count matrix that can be used for many different downstream analyses changing the way isomiRs are collapsed. The following command will merge all isomiRs into one feature: the reference miRNA.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw"><a href="../reference/counts.html">counts</a></span>(ids))</code></pre></div>
<pre><code>##                    cc1    cc2    cc3    cc4    cc5    cc6    cc7    ct1
## hsa-let-7a-2-3p      5     13      4      9     11      6      7      0
## hsa-let-7a-3p      767    707    630    609    731    389    681    258
## hsa-let-7a-5p   317730 244832 203888 260931 244784 153049 220563 208511
## hsa-let-7b-3p     1037   1949    679   1385   1884    697   1499    338
## hsa-let-7b-5p    69671  64702  42347  65322  60767  34975  56875  22215
## hsa-let-7c-3p       36     16     25     40     26     23     35      3
##                    ct2    ct3    ct4    ct5    ct6    ct7
## hsa-let-7a-2-3p      4      2     12     12      8      3
## hsa-let-7a-3p      496    343    635    622    452    519
## hsa-let-7a-5p   222066 154246 175523 189733 230690 199923
## hsa-let-7b-3p      931    494   1149   1194   1431    988
## hsa-let-7b-5p    45069  28312  41214  43058  61258  46600
## hsa-let-7c-3p       30     28     26     24     22     17</code></pre>
<p>The normalization uses <code>rlog</code> from <em><a href="http://bioconductor.org/packages/DESeq2">DESeq2</a></em> package and allows quick integration to another analyses like heatmap, clustering or PCA.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pheatmap)
ids =<span class="st"> </span><span class="kw"><a href="../reference/isoNorm.html">isoNorm</a></span>(ids, <span class="dt">formula =</span> <span class="op">~</span><span class="st"> </span>condition)
<span class="kw"><a href="http://www.rdocumentation.org/packages/pheatmap/topics/pheatmap">pheatmap</a></span>(<span class="kw"><a href="../reference/counts.html">counts</a></span>(ids, <span class="dt">norm=</span><span class="ot">TRUE</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,], 
         <span class="dt">annotation_col =</span> <span class="kw">data.frame</span>(<span class="kw">colData</span>(ids)[,<span class="dv">1</span>,<span class="dt">drop=</span><span class="ot">FALSE</span>]),
         <span class="dt">show_rownames =</span> <span class="ot">FALSE</span>, <span class="dt">scale=</span><span class="st">"row"</span>)</code></pre></div>
<p><img src="isomiRs_files/figure-html/package-norm-1.png" width="700"></p>
<div id="differential-expression-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#differential-expression-analysis" class="anchor"></a>Differential expression analysis</h3>
<p>The <code>isoDE</code> uses functions from <em><a href="http://bioconductor.org/packages/DESeq2">DESeq2</a></em> package. This function has parameters to create a matrix using only the reference miRNAs, all isomiRs, or some of them. This matrix and the design matrix are the inputs for DESeq2. The output will be a DESeqDataSet object, allowing to generate any plot or table explained in DESeq2 package vignette.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dds &lt;-<span class="st"> </span><span class="kw"><a href="../reference/isoDE.html">isoDE</a></span>(ids, <span class="dt">formula=</span><span class="op">~</span>condition)
<span class="kw">library</span>(DESeq2)
<span class="kw"><a href="http://www.rdocumentation.org/packages/DESeq2/topics/plotMA">plotMA</a></span>(dds)</code></pre></div>
<p><img src="isomiRs_files/figure-html/package-de-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/DESeq2/topics/results">results</a></span>(dds, <span class="dt">format=</span><span class="st">"DataFrame"</span>))</code></pre></div>
<pre><code>## log2 fold change (MLE): condition ct vs cc 
## Wald test p-value: condition ct vs cc 
## DataFrame with 6 rows and 6 columns
##                     baseMean log2FoldChange     lfcSE       stat    pvalue
##                    &lt;numeric&gt;      &lt;numeric&gt; &lt;numeric&gt;  &lt;numeric&gt; &lt;numeric&gt;
## hsa-let-7a-2-3p 6.600052e+00     -0.3917997 0.6094666 -0.6428568 0.5203170
## hsa-let-7a-3p   5.468055e+02     -0.2256857 0.2247883 -1.0039923 0.3153823
## hsa-let-7a-5p   2.206256e+05      0.1134702 0.2705028  0.4194789 0.6748662
## hsa-let-7b-3p   1.096787e+03     -0.3912745 0.3294638 -1.1876099 0.2349871
## hsa-let-7b-5p   4.741597e+04     -0.2352147 0.2260572 -1.0405099 0.2981030
## hsa-let-7c-3p   2.311776e+01     -0.1744332 0.3027031 -0.5762517 0.5644450
##                      padj
##                 &lt;numeric&gt;
## hsa-let-7a-2-3p 0.9895233
## hsa-let-7a-3p   0.9895233
## hsa-let-7a-5p   0.9895233
## hsa-let-7b-3p   0.9895233
## hsa-let-7b-5p   0.9895233
## hsa-let-7c-3p   0.9895233</code></pre>
<p>You can differentiate between reference sequences and isomiRs at 5’ end with this command:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dds =<span class="st"> </span><span class="kw"><a href="../reference/isoDE.html">isoDE</a></span>(ids, <span class="dt">formula=</span><span class="op">~</span>condition, <span class="dt">ref=</span><span class="ot">TRUE</span>, <span class="dt">iso5=</span><span class="ot">TRUE</span>)
<span class="kw">head</span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/DESeq2/topics/results">results</a></span>(dds, <span class="dt">tidy=</span><span class="ot">TRUE</span>))</code></pre></div>
<pre><code>##                          row    baseMean log2FoldChange     lfcSE
## 1            hsa-let-7a-2-3p   6.4387637     -0.4437940 0.5881691
## 2 hsa-let-7a-2-3p;iso_5p:TAA   0.1280730      1.1129483 3.0845751
## 3              hsa-let-7a-3p 454.5689202     -0.2068281 0.2164444
## 4     hsa-let-7a-3p;iso_5p:A   0.6517906      1.0184266 1.7906776
## 5     hsa-let-7a-3p;iso_5p:c  84.3104219     -0.3077734 0.2536067
## 6    hsa-let-7a-3p;iso_5p:ct   5.1044706     -0.5479279 0.5474512
##         stat    pvalue     padj
## 1 -0.7545346 0.4505283 0.988809
## 2  0.3608109 0.7182408 0.988809
## 3 -0.9555714 0.3392888 0.988809
## 4  0.5687381 0.5695339 0.988809
## 5 -1.2135854 0.2249061 0.988809
## 6 -1.0008707 0.3168893 0.988809</code></pre>
<p>Alternative, for more complicated cases or if you want to control more the differential expression analysis paramters you can use directly <em><a href="http://bioconductor.org/packages/DESeq2">DESeq2</a></em> package feeding it with the output of <code><a href="../reference/counts.html">counts(ids)</a></code> and <code>colData(ids)</code> like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dds =<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/DESeq2/topics/DESeqDataSet">DESeqDataSetFromMatrix</a></span>(<span class="kw"><a href="../reference/counts.html">counts</a></span>(ids),
                             <span class="kw">colData</span>(ids), <span class="dt">design =</span> <span class="op">~</span><span class="st"> </span>condition)</code></pre></div>
</div>
</div>
<div id="supervised-classification" class="section level2">
<h2 class="hasAnchor">
<a href="#supervised-classification" class="anchor"></a>Supervised classification</h2>
<p>Partial Least Squares Discriminant Analysis (PLS-DA) is a technique specifically appropriate for analysis of high dimensionality data sets and multicollineality <span class="citation">(Pérez-Enciso and Tenenhaus 2003)</span>. PLS-DA is a supervised method (i.e. makes use of class labels) with the aim to provide a dimension reduction strategy in a situation where we want to relate a binary response variable (in our case young or old status) to a set of predictor variables. Dimensionality reduction procedure is based on orthogonal transformations of the original variables (isomiRs) into a set of linearly uncorrelated latent variables (usually termed as components) such that maximizes the separation between the different classes in the first few components <span class="citation">(Xia and Wishart 2011)</span>. We used sum of squares captured by the model (R2) as a goodness of fit measure. We implemented this method using the <code>DiscriMiner</code> into <code>isoPLSDA</code> function. The output p-value of this function will tell about the statistical significant of the group separation using miRNA expression data. Moreover, the function <code>isoPLSDAplot</code> helps to visualize the results. It will plot the samples using the significant components (t1, t2, t3 …) from the PLS-DA analysis and the samples distribution along the components.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ids =<span class="st"> </span><span class="kw"><a href="../reference/isoCounts.html">isoCounts</a></span>(ids, <span class="dt">iso5=</span><span class="ot">TRUE</span>, <span class="dt">minc=</span><span class="dv">10</span>, <span class="dt">mins=</span><span class="dv">6</span>)
ids =<span class="st"> </span><span class="kw"><a href="../reference/isoNorm.html">isoNorm</a></span>(ids, <span class="dt">formula =</span> <span class="op">~</span><span class="st"> </span>condition)
pls.ids =<span class="st"> </span><span class="kw"><a href="../reference/isoPLSDA.html">isoPLSDA</a></span>(ids, <span class="st">"condition"</span>, <span class="dt">nperm =</span> <span class="dv">2</span>)
df =<span class="st"> </span><span class="kw"><a href="../reference/isoPLSDAplot.html">isoPLSDAplot</a></span>(pls.ids)</code></pre></div>
<p><img src="isomiRs_files/figure-html/package-pls-1.png" width="700"></p>
<p>The analysis can be done again using only the most important discriminant isomiRS from the PLS-DA models based on the analysis. We used Variable Importance for the Projection (VIP) criterion to select the most important features, since takes into account the contribution of a specific predictor for both the explained variability on the response and the explained variability on the predictors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pls.ids =<span class="st"> </span><span class="kw"><a href="../reference/isoPLSDA.html">isoPLSDA</a></span>(ids,<span class="st">"condition"</span>, <span class="dt">refinment =</span> <span class="ot">FALSE</span>, <span class="dt">vip =</span> <span class="fl">0.8</span>)</code></pre></div>
</div>
<div id="gene---mirna-integration" class="section level2">
<h2 class="hasAnchor">
<a href="#gene---mirna-integration" class="anchor"></a>Gene - miRNA integration</h2>
<p>The package offers a correlation analysis of miRNA and gene expression data. Having two SummarizedExperiments objects with their expression, the target prediction for each miRNA, the function <code>isoNetwork</code> and <code>isoPlotNetwork</code> can generate a summarized figure showing the relationship between expression profile, miRNA repression and enrichment analysis:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># library(org.Mm.eg.db)</span>
<span class="co"># library(clusterProfiler)</span>
<span class="kw">data</span>(isoExample)

<span class="co"># ego &lt;- enrichGO(row.names(assay(gene_ex_rse, "norm")),</span>
<span class="co">#                 org.Mm.eg.db, "ENSEMBL", ont = "BP")</span>
data =<span class="st"> </span><span class="kw"><a href="../reference/isoNetwork.html">isoNetwork</a></span>(mirna_ex_rse, gene_ex_rse, <span class="dt">target =</span> ma_ex,
                  <span class="dt">enrich =</span> ego, <span class="dt">summarize =</span> <span class="st">"group"</span>)</code></pre></div>
<pre><code>## Dimmension of cor matrix: 20 25</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/isoPlotNet.html">isoPlotNet</a></span>(data)</code></pre></div>
<p><img src="isomiRs_files/figure-html/isonetwork-1.png" width="672"></p>
<p>As an option, <code>org</code> can be <code>org.Mm.eg.db</code> and <code>genename</code> can be <code>ENSEMBL</code> and it will run <code>enrcihGO</code> internally.</p>
<p>To create the ma_ex matrix, the user can use <code>findTargets</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mirna_ma &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">gene =</span> <span class="kw">names</span>(gene_ex_rse)[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>],
                       <span class="dt">mir =</span> <span class="kw">names</span>(mirna_ex_rse))
ma_ex &lt;-<span class="st"> </span><span class="kw"><a href="../reference/findTargets.html">findTargets</a></span>(mirna_ex_rse, gene_ex_rse, mirna_ma)</code></pre></div>
<pre><code>## Dimmension of cor matrix: 20 20</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(ma_ex[,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])</code></pre></div>
<pre><code>##                    mmu-miR-101a-3p mmu-miR-107-3p mmu-miR-142a-3p
## ENSMUSG00000004530               0              0               0
## ENSMUSG00000005397               0              0               0
## ENSMUSG00000006386               0              0               0
## ENSMUSG00000016494               0              0               0
## ENSMUSG00000019997               0              0               0
## ENSMUSG00000021822               0              0               0
##                    mmu-miR-144-3p
## ENSMUSG00000004530              0
## ENSMUSG00000005397              0
## ENSMUSG00000006386              0
## ENSMUSG00000016494              0
## ENSMUSG00000019997              0
## ENSMUSG00000021822              0</code></pre>
<p>And to get the <code>mirna_ma</code> data.frame with the miRNA-target information, the user can use <code>mirna2targetscan</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(targetscan.Hs.eg.db)
mirna_ma &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mirna2targetscan.html">mirna2targetscan</a></span>(<span class="kw">c</span>(<span class="st">"hsa-miR-34c-5p"</span>))
<span class="kw">head</span>(mirna_ma)</code></pre></div>
<pre><code>##                         miRFamily Seedmatch  PCT  gene     targetscan
## 1 miR-34ac/34bc-5p/449abc/449c-5p      8mer 0.29 79719 hsa-miR-34c-5p
## 2 miR-34ac/34bc-5p/449abc/449c-5p      8mer 0.76   215 hsa-miR-34c-5p
## 3 miR-34ac/34bc-5p/449abc/449c-5p   7mer-1a 0.58  3983 hsa-miR-34c-5p
## 4 miR-34ac/34bc-5p/449abc/449c-5p      8mer 0.73    29 hsa-miR-34c-5p
## 5 miR-34ac/34bc-5p/449abc/449c-5p      8mer 0.67 64746 hsa-miR-34c-5p
## 6 miR-34ac/34bc-5p/449abc/449c-5p      8mer 0.75    40 hsa-miR-34c-5p
##              mir         ext         num     letter
## 1 hsa-miR-34c-5p hsa-miR-34c hsa-miR-34c hsa-miR-34
## 2 hsa-miR-34c-5p hsa-miR-34c hsa-miR-34c hsa-miR-34
## 3 hsa-miR-34c-5p hsa-miR-34c hsa-miR-34c hsa-miR-34
## 4 hsa-miR-34c-5p hsa-miR-34c hsa-miR-34c hsa-miR-34
## 5 hsa-miR-34c-5p hsa-miR-34c hsa-miR-34c hsa-miR-34
## 6 hsa-miR-34c-5p hsa-miR-34c hsa-miR-34c hsa-miR-34</code></pre>
</div>
<div id="session-info" class="section level2">
<h2 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session info</h2>
<p>Here is the output of <code>sessionInfo</code> on the system on which this document was compiled:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sessionInfo</span>()</code></pre></div>
<pre><code>## R version 3.4.4 (2018-03-15)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS High Sierra 10.13.3
## 
## Matrix products: default
## BLAS: /Library/Frameworks/R.framework/Versions/3.4/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.4/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] parallel  stats4    stats     graphics  grDevices utils     datasets 
## [8] methods   base     
## 
## other attached packages:
##  [1] targetscan.Hs.eg.db_0.6.1  AnnotationDbi_1.40.0      
##  [3] DESeq2_1.18.1              pheatmap_1.0.10           
##  [5] bindrcpp_0.2.2.9000        isomiRs_1.9.1             
##  [7] SummarizedExperiment_1.8.1 DelayedArray_0.4.1        
##  [9] matrixStats_0.53.1         Biobase_2.38.0            
## [11] GenomicRanges_1.30.3       GenomeInfoDb_1.14.0       
## [13] IRanges_2.12.0             S4Vectors_0.16.0          
## [15] BiocGenerics_0.24.0        DiscriMiner_0.1-29        
## [17] BiocStyle_2.6.1           
## 
## loaded via a namespace (and not attached):
##   [1] assertive.base_0.0-7        colorspace_1.3-2           
##   [3] rjson_0.2.20                rprojroot_1.3-2            
##   [5] circlize_0.4.4              htmlTable_1.12             
##   [7] XVector_0.18.0              ggdendro_0.1-20            
##   [9] GlobalOptions_0.1.0         base64enc_0.1-3            
##  [11] fs_1.2.2                    rstudioapi_0.7             
##  [13] roxygen2_6.0.1.9000         assertive.sets_0.0-3       
##  [15] ggrepel_0.8.0               bit64_0.9-7                
##  [17] xml2_1.2.0                  codetools_0.2-15           
##  [19] splines_3.4.4               logging_0.7-103            
##  [21] mnormt_1.5-5                geneplotter_1.56.0         
##  [23] knitr_1.20                  Formula_1.2-3              
##  [25] Nozzle.R1_1.1-1             annotate_1.56.2            
##  [27] cluster_2.0.7-1             readr_1.1.1                
##  [29] compiler_3.4.4              backports_1.1.2            
##  [31] assertthat_0.2.0            Matrix_1.2-14              
##  [33] lazyeval_0.2.1              limma_3.34.9               
##  [35] acepack_1.4.1               htmltools_0.3.6            
##  [37] tools_3.4.4                 gtable_0.2.0               
##  [39] glue_1.2.0                  GenomeInfoDbData_1.0.0     
##  [41] reshape2_1.4.3              dplyr_0.7.6                
##  [43] Rcpp_0.12.17                pkgdown_1.1.0              
##  [45] gdata_2.18.0                nlme_3.1-137               
##  [47] psych_1.8.4                 stringr_1.3.1              
##  [49] DEGreport_1.17.3            gtools_3.8.1               
##  [51] XML_3.98-1.11               edgeR_3.20.9               
##  [53] zlibbioc_1.24.0             MASS_7.3-50                
##  [55] scales_0.5.0                hms_0.4.2                  
##  [57] RColorBrewer_1.1-2          ComplexHeatmap_1.17.1      
##  [59] yaml_2.1.19                 memoise_1.1.0              
##  [61] gridExtra_2.3               ggplot2_3.0.0              
##  [63] rpart_4.1-13                reshape_0.8.7              
##  [65] latticeExtra_0.6-28         stringi_1.2.3              
##  [67] RSQLite_2.1.1               genefilter_1.60.0          
##  [69] desc_1.2.0                  checkmate_1.8.5            
##  [71] caTools_1.17.1              BiocParallel_1.12.0        
##  [73] shape_1.4.4                 rlang_0.2.1                
##  [75] pkgconfig_2.0.1             commonmark_1.5             
##  [77] bitops_1.0-6                evaluate_0.10.1            
##  [79] lattice_0.20-35             purrr_0.2.5                
##  [81] bindr_0.1.1.9000            labeling_0.3               
##  [83] htmlwidgets_1.2             cowplot_0.9.2              
##  [85] bit_1.1-14                  tidyselect_0.2.4           
##  [87] GGally_1.4.0                plyr_1.8.4                 
##  [89] magrittr_1.5                R6_2.2.2                   
##  [91] gplots_3.0.1                Hmisc_4.1-1                
##  [93] DBI_1.0.0                   withr_2.1.2                
##  [95] pillar_1.2.3                foreign_0.8-70             
##  [97] survival_2.42-3             RCurl_1.95-4.10            
##  [99] nnet_7.3-12                 tibble_1.4.2               
## [101] crayon_1.3.4                KernSmooth_2.23-15         
## [103] rmarkdown_1.10              GetoptLong_0.1.7           
## [105] locfit_1.5-9.1              grid_3.4.4                 
## [107] data.table_1.11.4           blob_1.1.1                 
## [109] ConsensusClusterPlus_1.42.0 digest_0.6.15              
## [111] xtable_1.8-2                tidyr_0.8.1                
## [113] munsell_0.5.0</code></pre>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-barturen2014">
<p>Guillermo, Barturen, Rueda Antonio, Hamberg Maarten, Alganza Angel, Lebron Ricardo, Kotsyfakis Michalis, Shi BuJun, KoppersLalic Danijela, and Hackenberg Michael. 2014. “sRNAbench: profiling of small RNAs and its sequence variants in single or multi-species high-throughput experiments.” <em>Methods in Next Generation Sequencing</em> 1 (1): 2084–7173. doi:<a href="https://doi.org/10.2478/mngs-2014-0001">10.2478/mngs-2014-0001</a>.</p>
</div>
<div id="ref-emarti">
<p>Martí, Eulàlia, Lorena Pantano, Mónica Bañez-Coronel, Franc Llorens, Elena Miñones-Moyano, Sílvia Porta, Lauro Sumoy, Isidre Ferrer, and Xavier Estivill. 2010. “A myriad of miRNA variants in control and Huntington’s disease brain regions detected by massively parallel sequencing.” <em>Nucleic Acids Res.</em> 38: 7219–35. doi:<a href="https://doi.org/10.1093/nar/gkq575">10.1093/nar/gkq575</a>.</p>
</div>
<div id="ref-morin">
<p>Morin, R. D., M. D. O’Connor, M. Griffith, F. Kuchenbauer, A. Delaney, A.-L. Prabhu, Y. Zhao, et al. 2008. “Application of massively parallel sequencing to microRNA profiling and discovery in human embryonic stem cells.” <em>Genome Res.</em> 18: 610–21. doi:<a href="https://doi.org/10.1101/gr.7179508">10.1101/gr.7179508</a>.</p>
</div>
<div id="ref-isomirs">
<p>Pantano L, Estivil X, Marti E. 2010. “SeqBuster.” <em>Nucleic Acids Res.</em> 38: e34. doi:<a href="https://doi.org/10.1093/nar/gkp1127">10.1093/nar/gkp1127</a>.</p>
</div>
<div id="ref-perezenciso">
<p>Pérez-Enciso, Miguel, and Michel Tenenhaus. 2003. “Prediction of clinical outcome with microarray data: a partial least squares discriminant analysis (PLS-DA) approach.” <em>Human Genetics</em> 112: 581–92. doi:<a href="https://doi.org/10.1007/s00439-003-0921-9">10.1007/s00439-003-0921-9</a>.</p>
</div>
<div id="ref-xia">
<p>Xia, Jianguo, and David S Wishart. 2011. “Web-based inference of biological patterns, functions and pathways from metabolomic data using MetaboAnalyst.” <em>Nature Protocols</em> 6: 743–60. doi:<a href="https://doi.org/10.1038/nprot.2011.319">10.1038/nprot.2011.319</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#citing-isomirs">Citing isomiRs</a></li>
      <li><a href="#input-format">Input format</a></li>
      <li><a href="#isomirdataseq-class">IsomirDataSeq class</a></li>
      <li><a href="#reading-input">Reading input</a></li>
      <li><a href="#descriptive-analysis">Descriptive analysis</a></li>
      <li><a href="#count-data">Count data</a></li>
      <li><a href="#supervised-classification">Supervised classification</a></li>
      <li><a href="#gene---mirna-integration">Gene - miRNA integration</a></li>
      <li><a href="#session-info">Session info</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Lorena Pantano, Georgia Escaramis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
